# 回顾

• 一元（单变量）函数  
• 一元函数的数据拟合的方法  
• 到哪找？  
• 确定某个函数集合（“池子”），具有某种结构容易表达（比如线性函数空间），且尽量广泛（表达能力强）  
• 找哪个？  
• 度量哪个函数是好的/“最好”的，定义损失函数，包括数据误差项（逼近数据的度量）与正则项（对函数性质的度量）  
• 怎么找？  
• 优化求解：不同的优化方法与技巧  
• 线性问题：解线性方程或线性方程组  
• 非线性问题：  
• 凸问题：有理论保证  
• 非凸问题：难！数值求解（ 梯度下降法、牛顿法、拟牛顿法、L‐BFGS, … ），须选择合适初值、步长等；一般要根据具体的优化问题形式及特点来设计合适的优化方法！

# 多元函数
多元函数（多变量）
• 多个变量的函数
• 例子：二元函数
𝑓:𝑅 ? → 𝑅 ?
𝑦 ? 𝑓 𝑥 ? ,𝑥 ? ,…,𝑥 ?
𝑥 ?
⋮
𝑥 ?
→ 𝑦
二元函数的基函数构造
• 方法：张量积形式，即用两个一元函数的基函数
的相互乘积来定义
• 比如：二次二元多项式函数 的基函数
? ?
1 𝒙 𝒙 𝟐
1 1 𝒙 𝒙 𝟐
𝒚 𝒚 𝒙𝒚 𝒙 𝟐 𝒚
𝒚 𝟐 𝒚 𝟐 𝒙𝒚 𝟐 𝒙 𝟐 𝒚 𝟐
三次张量积多项式
1 𝑢 𝑢 ? 𝑢 ?
1 1 𝑢 𝑢 ? 𝑢 ?
𝑣 𝑣 𝑣𝑢 𝑣𝑢 ? 𝑣𝑢 ?
𝑣 ? 𝑣 ? 𝑣 ? 𝑢 𝑣 ? 𝑢 ? 𝑣 ? 𝑢 ?
𝑣 ? 𝑣 ? 𝑣 ? 𝑢 𝑣 ? 𝑢 ? 𝑣 ? 𝑢 ?
三次张量积函数
张量积基函数
𝑏 ? 𝑢 𝑏 ? 𝑢 𝑏 ? 𝑢 𝑏 ? 𝑢
𝑏 ? 𝑣 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢
𝑏 ? 𝑣 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢
𝑏 ? 𝑣 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢
𝑏 ? 𝑣 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢 𝑏 ? 𝑣 𝑏 ? 𝑢
多元函数的张量积定义
• 优点：定义简单，多个
一元基函数的乘积形式
• 不足：
• 随着维数增加，基函数个
数急剧增加，导致变量技
据增加（求解系统规模急
剧增加，求解代价大）
1 𝒙 𝒙 𝟐
1 1 𝒙 𝒙 𝟐
𝒚 𝒚 𝒙𝒚 𝒙 𝟐 𝒚
𝒚 𝟐 𝒚 𝟐 𝒙𝒚 𝟐 𝒙 𝟐 𝒚 𝟐
多元函数的神经网络表达
• 用一个单变量函数 （称为激活函数）的不
同仿射变换来构造 “基函数”：基函数数目可控
𝑓:
𝑥 ?
⋮
𝑥 ?
→ 𝑦
𝑥 ?
𝜎?𝑥?
𝑦
1
𝜎?𝑥?
𝜎?𝑥?
1
输入层 隐层
输出层
… …
𝑎 ?
?
𝑥 ?
𝑥 ?
𝑎 ?
?
… …
𝑎 ?
?
𝑤 ?
𝑤 ?
𝑤 ?
𝑦 ? 𝑓 𝑥 ? ,𝑥 ? ,…,𝑥 ?
? 𝑤 ? ? ? 𝑤 ? 𝜎?𝑎 ?
? 𝑥 ?
? ⋯𝑎 ?
? 𝑥 ?
? ⋯? 𝑎 ?
? 𝑥 ?
? 𝑏 ? ?
?
???
𝑤 ?
𝑏 ?
向量值函数
向量值函数（多个应变量）
• 先看单变量的：
• 看成多个单变量函数，各个函数独立无关
• 一般会用同样的基函数（共享基函数）
𝑓:𝑅 ? → 𝑅 ? 𝑥 →
𝑦 ?
⋮
𝑦 ?
?
𝑦 ? ? 𝑓
? ?𝑥?
⋮
𝑦 ? ? 𝑓
? ?𝑥?
向量值函数（多个应变量）
• 几何解释：
• 一个实数𝑥 ∈ 𝑅 ? 映射到𝑚维空间𝑅 ? 的一个点，轨迹
构成𝑅 ? 的一条“曲线”
• 本质维度为1
𝑓:𝑅 ? → 𝑅 ?
𝑥
𝑅 ?
?
𝑦 ? ? 𝑓
? ?𝑥?
⋮
𝑦 ? ? 𝑓
? ?𝑥?
特例：平面参数曲线
• 几何解释：
一条曲线由一个变量参数𝑡决定，也称为单参数曲线
• 参数𝑡可看成该曲线的“时间”变量
• 可灵活表达非函数型的曲线（任意曲线）
𝑓:𝑅 ? → 𝑅 ?
? 𝑥 𝑥 𝑦 ? 𝑦?𝑡?
𝑡 ∈ ?0,1?
𝑡 𝑥
𝑦
特例：空间参数曲线
• 几何解释：
一条曲线由一个变量参数𝑡决定，也称为单参数曲线
• 参数𝑡可看成该曲线的“时间”变量
• 可灵活表达非函数型的曲线（任意曲线）
𝑓:𝑅 ? → 𝑅 ?
?
𝑥 𝑥 𝑦 𝑦?𝑡?
𝑧 ? 𝑧?𝑡?
𝑡 ∈ ?0,1?
𝑡
特例：参数曲面
• 几何解释：
• 一张曲面由两个参数?𝑢,𝑣?决定，也称为双参数曲面
• 可灵活表达非函数型的任意曲面
𝑓:𝑅 ? → 𝑅 ?
?
𝑥 𝑥 𝑦 𝑦?𝑢,𝑣?
𝑧 ? 𝑧?𝑢,𝑣?
?𝑢,𝑣? ∈ 0,1 ? ?0,1?
特例：二维映射
• 几何解释：
• 二维区域之间的映射
• 可看成特殊的曲面（第三个维度始终为0）
• 应用：图像变形
𝑓:𝑅 ? → 𝑅 ? ? 𝑥 𝑥 𝑦 ? 𝑦?𝑢,𝑣?
?𝑢,𝑣? ∈ 0,1 ? ?0,1?
特例：二维映射
• 几何解释：
• 三维体区域之间的映射
• 应用：体形变、体参数化
𝑓:𝑅 ? → 𝑅 ? ?
𝑥 𝑥 𝑦 𝑦?𝑢,?
𝑧 ? 𝑧?𝑢,𝑣,𝑤?
?𝑢,𝑣,𝑤? ∈ ?0,1? ?
特例：降维映射（低维投影）
? ?
• 降维映射一般有信息丢失
• 丢失的信息大部分情况下不可逆，即无法恢复
一般映射
• 如果 ，为低维到高维的映射（高维的超曲
面， 维流形曲面），本征维度为
• 如果 ，为降维映射
• 一般信息有损失
• 如果𝑅 ? 中的点集刚好位于一个𝑚 维（或小于𝑚 ）的
流形上，则映射可能是无损的，即可以被恢复的
? ?
低维空间之间的函数
曲线拟合
曲线拟合问题
• 输入：给定平面上系列点
? ?
• 输出：一条参数曲线，拟合这些点
𝑓:𝑅 ? → 𝑅 ?
? 𝑥 𝑥 𝑦 ? 𝑦?𝑡?
𝑡 ∈ ?0,1?
应该怎么做？
曲线拟合问题
• 问题：对数据点?𝑥 ? ,𝑦 ? ?，对应哪个参数𝑡 ? ？
• 误差度量：𝐸 ? ∑
𝑥 ? ?
𝑦?𝑡 ? ?
 ?
𝑥 ?
𝑦 ?
?
? ∑ 𝒑?𝑡 ? ? ? 𝒑 ?
? ?
???
?
???
𝑡
? 𝑥 𝑥 𝑦 ? 𝑦?𝑡?
𝑡 ∈ ?0,1?
矢量符号化表达：
𝒑 ? 𝒑 𝑡 ?
𝑥 𝑦?𝑡?
参数化问题
• 求数据点所对应的参数：一个降维的问题！
• 然后极小化误差度量：𝐸 ? ∑ 𝒑?𝑡 ? ? ? 𝒑 ?
? ?
???
𝑡
? 𝑥 𝑥 𝑦 ? 𝑦?𝑡?
𝑡 ∈ ?0,1?
点列的参数化
• Equidistant (uniform) parameterization
𝑡 ??? ? 𝑡 ? ? const
• e.g. 𝑡 ? ? 𝑖
• Geometry of the data points is not considered
• Chordal parameterization
• 𝑡 ??? ? 𝑡 ? ? 𝒌 ??? ? 𝒌 ?
• Parameter intervals proportional to the distances of
neighbored control points
点列的参数化
• Centripetal parameterization
• 𝑡 ??? ? 𝑡 ? ? 𝒌 ??? ? 𝒌 ?
• Foley parameterization
• Involvement of angles in the control polygon
• 𝑡 ??? ? 𝑡 ? ? 𝒌 ??? ? 𝒌 ? ⋅ ?1 ?
?
?
? ?
?
𝒌 ? ?𝒌 ???
𝒌 ? ?𝒌 ??? ? 𝒌 ??? ?𝒌 ?
?
?
?
? ?
???
𝒌 ??? ?𝒌 ?
𝒌 ??? ?𝒌 ? ? 𝒌 ??? ?𝒌 ???
?
• with 𝛼? ? ? min 𝜋 ? 𝛼 ? ,
?
?
• and 𝛼 ? ? angle 𝒌 ??? ,𝒌 ? ,𝒌 ???
一个例子
• Examples: Uniform parameterization
Curve                                 Curvature plot
一个例子
• Examples: Chordal parameterization
Curve                            Curvature plot
一个例子
• Examples: Centripetal parameterization
Curve                                 Curvature plot
一个例子
• Examples: Foley parameterization
Curve                                 Curvature plot
另一个例子
uniform chord length centripetal
点的参数化对曲线拟合的影响很大，需要好的参数化！
曲面参数化
• 三维的点找二维的参数：一个降维的问题！
曲面参数化的应用
• 地图绘制（地理学）
35
曲面参数化的应用
• 纹理映射
作业2情况
• 作业2情况
• 演示优秀demo
• 优秀代码和优秀报告
• 其他学员可以继续完成提交
• 可参照优秀作业尽快完成，赶上大部队
作业3
• 任务
• 使用单参数曲线来拟合平面上任意有序点列
• 目的
• 学习参数曲线拟合
• 使用各种参数化方法，并进行比较
• 要求
• 可以使用其他语言(Matlab, Python等)或其他框架
• Deadline：2020 年10 月31日晚
谢 谢 ！
