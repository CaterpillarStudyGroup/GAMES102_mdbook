# ÂõûÈ°æ

## \\(R^3\\)‰∏≠ÁöÑÂèÇÊï∞Êõ≤Èù¢   

‚Ä¢ Êú¨Ë¥®ÊòØ‰∫åÁª¥ÁöÑÔºà‰∫åÁª¥ÊµÅÂΩ¢Ôºâ    
‚Ä¢ Êõ≤Èù¢ÁöÑÊØè‰∏™ÁÇπÂØπÂ∫î‰∏éÂèÇÊï∞Âüü‰∏äÁöÑ‰∏Ä‰∏™ÁÇπÔºàÁß∞‰∏∫ÂèÇÊï∞Ôºâ   

$$
f:\Omega \to S
$$

$$
(u,v)\to \begin{cases}
¬†x=x(u,v),\\\\
y=y(u,v), ¬†\\\\
z=z(u,v),
\end{cases}
$$

![](../assets/ÂèÇÊï∞1.png)    


## ÈÄÜÈóÆÈ¢òÔºöÂèÇÊï∞Âåñ(Parameterization)   

‚Ä¢ ÈóÆÈ¢òÔºöÁªôÂÆö‰∏ÄÂº†Êõ≤Èù¢ÔºåÂ¶Ç‰ΩïÊâæÂÖ∂‰∫åÁª¥ÁöÑÂèÇÊï∞ÂÆö‰πâÂüüÔºü   
‚Ä¢ ÂèàÁß∞‰∏∫ÔºöÊõ≤Èù¢Â±ïÂºÄ(flattening)   


> Find a mapping \\(ùëì: ùëÜ ‚äÇ ùëÖ^3 ‚Üí Œ© ‚äÇ ùëÖ^2 \\)   

![](../assets/ÂèÇÊï∞2.png)    

# ÂèÇÊï∞Âåñ

## ÂèÇÊï∞ÂåñÁöÑÈáçË¶ÅÊÄß   

‚Ä¢ ‰æãÂ≠êÔºöBÊ†∑Êù°Êõ≤Èù¢ÊãüÂêà   

![](../assets/ÂèÇÊï∞3.png)    


# ÂèÇÊï∞ÂåñÊúüÊúõ‰øùÊåÅÁöÑÂá†‰ΩïÊÄßË¥®   

‚Ä¢ ‰øùËßíÊò†Â∞Ñ(angle‚Äêpreserving)ÔºöconformalÔºàÂÖ±ÂΩ¢Ôºâ    
‚Ä¢ ‰øùÈù¢ÁßØÊò†Â∞Ñ(area‚Äêpreserving)Ôºöauthalic    
‚Ä¢ Á≠âË∑ùÊò†Â∞Ñ(isometric)Ôºöconformal + authalic    

![](../assets/ÂèÇÊï∞6.png)    

‚Ä¢ \\(f\\) is approximated by **piecewise linear maps** between pairs of triangles    

# Isometric Flattening    

![](../assets/ÂèÇÊï∞9.png)    

> R Êää3D‰∏âËßíÂΩ¢ÊóãËΩ¨‰∏∫Âπ≥Èù¢‰∏âËßíÂΩ¢„ÄÇ    
\\(\phi \\)ÊòØ‰∏§‰∏™Âπ≥Èù¢‰∏âËßíÂΩ¢‰πãÈó¥ÁöÑÂèòÂΩ¢„ÄÇÊâ≠Êõ≤ÈÉΩÊù•Ëá™\\(\phi \\)    

\\(\phi ÊòØÂ•áÂÜµÁü©ÈòµÔºåÂõ†Ê≠§2DÊòØ3√ó3.Êâ≠Êõ≤ÈÉΩÊù•Ëá™L(2√ó2)\\)          

# Distortion Measure    

$$
L=U\begin{pmatrix}\sigma_1  & 0
\\\\0  &\sigma _2
\end{pmatrix}V^*
$$

$$
\sigma _2\ge \sigma _1
$$

![](../assets/ÂèÇÊï∞10.png)    

> \\(L ÊòØ 2√ó2Ôºå ÂÅöSVD, \sigma_{1}Âíå\sigma_{2}\\)ÊòØÂ•áÂºÇÂÄº„ÄÇ„ÄÄ    

‚Ä¢ angle‚Äêpreserving (conformal) \\(\sigma _1=\sigma _2\\)   

‚Ä¢ area‚Äêpreserving (authalic) \\(\sigma _1\sigma _2\\)    

‚Ä¢ length‚Äêpreserving (isometric) \\(\sigma _1=\sigma _2=1\\)   



# Desired Property

## Low distortion    

![](../assets/ÂèÇÊï∞12.png)    

High distortion    


## Local Injectivity   

![](../assets/ÂèÇÊï∞14.png)    

> ÁøªËΩ¨\\(\sigma_{1}\cdot \sigma_{2}<0 \\)     

## Flip free triangles    

![](../assets/ÂèÇÊï∞15.png)    

Flip/Foldover triangles    


## Distortion (Flip/Foldover)    

![](../assets/ÂèÇÊï∞16.png)    
![](../assets/ÂèÇÊï∞17.png)    
![](../assets/ÂèÇÊï∞18.png)    
![](../assets/ÂèÇÊï∞19.png)    


# Methods of Mesh Parameterization    

* Tutte‚Äôs method and its variants   
‚Ä¢ Tutte‚Äôs method [Tutte 1963; Floater 1997, 2003]   
‚Ä¢ Variants [Weber and Zorin 2014; Aigerman and Lipman 2015,  2016; Aigerman et al. 017; Bright et al. 2017; ]    
* Geometry‚Äêbased optimization methods   
‚Ä¢ Representation based methods [Sheffer and Sturler 2001;  Sheffer et al. 2005; Chien et al. 2016b; Fu and Liu 2016]     
‚Ä¢ ARAP [Sorkine and Alex 2007; Liu et al. 2008]   
‚Ä¢ Bounded distortion methods [Lipman 2012; Aigerman et al. 2014; Kovalsky et al. 015]     
* Foldover free guaranteed optimization methods    
‚Ä¢ [Smith and Schaefer 2015; Kovalsky et al. 2016; Jiang et al. 2017; Claici et al. 2017; Rabinovich et al. 2017; Shtengel et al.  2017; Zhu et al. 2018]    



## Tutte‚Äôs embedding method   

&#x2705; Map the triangulation within a **convex** boundary by solving a sparse linear system    

![](../assets/ÂèÇÊï∞20.png)    

$$
p_i=\sum_{({j:(i,j)\in edges})}\lambda_{i,jk}p_k,\sum_{k=1}^{d_i} \lambda_{i,jk}=1,\lambda_{i,jk}>0
$$


[Floater. Parametrization and smooth approximation of surfaces. CAGD 1997.]   


> Â§ñÈÉ®ÁÇπÔºöÊò†Â∞ÑÂà∞ convex boundary ‰∏ä„ÄÇ   
ÂÜÖÈÉ®ÁÇπÔºöl ÈÇªÂüüÁÇπÁöÑÁ∫øÊÄßÁªÑÂêàÔºåÊùÉËá™Â∑±ÂÆö‰πâ„ÄÇ   
ÈÄöËøáÊ±ÇËß£Á®ÄÁñèÊñπÁ®ãÁªÑÁ°ÆÂÆöÁÇπÁöÑ‰ΩçÁΩÆ„ÄÇ   
‰ºòÁÇπÔºöÁÆÄÂçï„ÄÅ‰∏çÁøªËΩ¨„ÄÇ    
Áº∫ÁÇπÔºöÊâ≠Êõ≤Â§ß„ÄÇ  

&#x2705; Foldover‚Äêfree result with a theoretical **guarantee**    


> Theorem [Tutte,63], [Maxwel,1864] :    
‚Ä¢ If G=<V,E> is a 3‚Äêconnected planar graph (triangular mesh)
then any barycentric embedding provides a valid parameterization.     

$$
Wx=b_x
$$

$$
Wy=b_y
$$


$$
W_{ij}\begin{cases}
¬†<0 &   (i,j)\in E\\\\
-\sum_ {j\ne i}w_{ij} ¬† & (i,j)\\\\
0  & otherwise
\end{cases}
$$


W is symmetric: \\(w_{ij}=w_{ji}\\)     


&#x2705; Usually **high distortion**    

![](../assets/ÂèÇÊï∞21.png)    


### Variants of Tutte‚Äôs embedding method
&#x2705; Foldover‚Äêfree result with theoretical **guarantees**    

![](../assets/ÂèÇÊï∞22.png)    


## Angle Based Flattening (ABF) & ABF++    
[Sheffer and Sturler 2001; Sheffer et al. 2005]    


* Triangular 2D mesh is defined by its angles    
‚Ä¢ Define problem in angle space    
* Angle based formulation    
‚Ä¢ Distortion as function of angles    
‚Ä¢ Validity ‚Äê set of angle constraints    

![](../assets/ÂèÇÊï∞23.png)     

> Âü∫‰∫éËßíÂ∫¶ÁöÑÂ±ïÂºÄÔºåÊääËßíÂ∫¶ÂΩì‰ΩúÂèòÈáèÔºåÊ±ÇËß£ÂèÇÊï∞ÂåñÁöÑÁΩëÊ†º 
   
### Constrained Minimization    

‚Ä¢ Notations:    

![](../assets/ÂèÇÊï∞24.png)     


‚Ä¢ Objective: minimize (relative) deviation of angles     

$$
F(\alpha )=\sum_{i,j}w_i^j(\alpha _i^j-\beta _i^j)^2
$$

Initial choice for weights:    

$$
w_i^j=\beta  _i^{j^-2}
$$

### Constraints    

‚Ä¢ To avoid flipped triangles   

$$
g^1(\alpha )\equiv \alpha _i^j\ge \varepsilon
$$

$$
g^2(\alpha )\equiv \alpha _i^1+\alpha _i^2+\alpha _i^3=\pi 
$$

$$
g^3(\alpha )\equiv \sum _k\alpha _i^j(k)=2\pi 
$$

$$
g^4(\alpha )\equiv \prod _k\sin(\alpha _i^{j(k)-1})-\prod _k\sin(\alpha _i^{j(k)+1})=0
$$


![](../assets/ÂèÇÊï∞25.png)     

$$
\frac{l_1}{l_2} =\frac{\sin(\alpha _1) }{\sin(\alpha _2) } 
$$

$$
\frac{l_1}{l_2} \cdots \frac{l_2}{l_1}=\frac{\sin(\alpha _1) }{\sin(\alpha _2) }\cdots \frac{\sin(\alpha _i) }{\sin(\alpha _j) }  
$$



### Solution    

‚Ä¢ Use Lagrange Multipliers    

$$
F^*(\alpha ,\mu )=F(\alpha )+\mu _1g^2(\alpha)+\mu _2g^3(\alpha)+\mu _3g^4(\alpha )
$$

‚Ä¢ Solve the min‚Äêmax problem (minimum on Œ±, maximum on ¬µ)   

$$
\min_{\alpha } \max_\mu F^*(\alpha ,\mu )
$$

‚Ä¢ Reached when all derivatives are zero    
‚Ä¢ Have non‚Äêlinear system of equations    
‚Ä¢ Use Newton method to solve    

> Áî® Lagrange ÁÆóÊ≥ïËß£Â∏¶Á∫¶ÊùüÁöÑ‰ºòÂåñÈóÆÈ¢ò   

### Examples    

![](../assets/ÂèÇÊï∞26.png)     

## As‚Äêrigid‚Äêas‚Äêpossible (ARAP) [Liu et al. 2008]     


* Measuring the approximation between the linear mapping and the rigidity (the optimal rotation)   
* Local/global optimization    
‚Ä¢ Local: compute singular values    
‚Ä¢ Global: solve linear systems    
* No theoretically guaranteed to avoid foldovers     

![](../assets/ÂèÇÊï∞27.png)     

[Ligang Liu et al. A Local/Global Approach to Mesh Parameterization.  SGP 2008.]    



## Simplex Assembly [Fu and Liu 2016]    


&#x2705;Instead of vertex positions, treat the affine transformation as variables    
&#x2705;Use a barrier function to prevent the inversion    
&#x2705;No theoretically guaranteed to avoid foldovers        

![](../assets/ÂèÇÊï∞28.png)     

> [Fu and Liu. Computing Inversion‚ÄêFree Mappings by Simplex Assembly. Siggraph Asia 2016]    

> ‰ºòÂåñ‰∏âËßíÂΩ¢ÂèòÊç¢ÁöÑÁ≥ªÊï∞     

## Flip‚Äêfree parameterization methods     

* Start with a flip‚Äêfree (valid) initialization    
* Reducing the distortion while guaranteeing the validity    
‚Ä¢ Generally non‚Äêconvex nonlinear optimization    

![](../assets/ÂèÇÊï∞29.png)     

### Low distortion cost functions     

![](../assets/ÂèÇÊï∞30.png)     


### Formulation of Optimization    

$$
\min_{V} E(V)=\sum _{t\in T}(\sigma _1^2+\frac{1}{\sigma _1^2} +\sigma _2^2+\frac{1}{\sigma _2^2})
$$

s.t  \\(\sigma _1\sigma _2>0,\\)  \\(\forall t\\)    

‚Ä¢ The cost function is highly **nonlinear** and **nonconvex**   
‚Ä¢ The constraints are **nonlinear**    
‚Ä¢ The Heissian matrix is highly **non‚Äêdefinite**     

> Computationally expensive for large scale meshes!   



### Solver for the optimization    


Input: a valid parameterization initialization \\(ùë•_0\\)    
Repeat    
\\(p=-H^{-1}\nabla E(x)\\) How to find a good decent direction?   

\\(ùõº_{max}\\)‚Üê injective maximal search step    
\\(ùõº\\) ‚Üêline search by backtracking from \\(ùõº_{max}\\)        
\\(x ‚Üê ùíô + ùõºp\\)    

Until converged    
**Output**: a locally injective parameterization     


### Maximal Search Step    

&#x2705; Explicitly limit the maximal line search step to 
prevent foldover    

$$
det\begin{pmatrix}(U_2+V_2t)-(U_1+V_1t)
 \\\\(U_3+V_3t)-(U_1+V_1t)
\end{pmatrix}=0
$$

![](../assets/ÂèÇÊï∞31.png)  

&#x2705; Use a locally supported barrier function to 
prevent the boundary collision    

$$
\max  (0,\frac{\in }{dist(U_i,\overline{U_1U_2}) } -1)^2
$$

![](../assets/ÂèÇÊï∞32.png)     

&#x2705; Solver: L‚ÄêBFGS    

> Smith and Schaefer. Bijective Parameterization with Free Boundaries. Siggraph 2015.    

> ‰ª• Tuttle ÁÆóÊ≥ï‰∏∫Âü∫Á°ÄÔºåË∞ÉÊï¥ËæπÁïåÁÇπ‰ΩçÁΩÆÔºåÂáèÂ∞ëÊâ≠Êõ≤  
Â∫¶ÈáèÊâ≠Êõ≤ÁöÑÊñπÊ≥ï[22:43]ÔºàÊúÄÂêé‰∏Ä‰∏™ÊúÄÂ∏∏Áî®Ôºâ    
Â±ÄÈôêÊÄßÔºöÈùûÁ∫øÊÄß„ÄÅÈùûÂá∏ÈóÆÈ¢ò„ÄÅ‰∏îÂèÇÊï∞Â§ö    
Âõ†Ê≠§‰ºòÂåñÊïàÁéá‰Ωé  

## Accelerated Quadratic Proxy (AQP)   

&#x2705; **H** = discrete Laplacian L    
&#x2705; Acceleration     
&#x2705; First‚Äêorder metho    

![](../assets/ÂèÇÊï∞33.png)     

> Kovalsky et al. Accelerated Quadratic Proxy for eometric Optimization. Siggraph 2016.     

> Âà©Áî®Á¶ªÊï£ Laplacian ‰Ωú‰∏∫ Hessian ÁöÑËøë‰ºº     
SLIM: \\(\dots ÔºåÂä†Êú∫ \dots \\)     
ANVF:\\(\dots ÂêëÈáèÂú∫ÁÆóÂ≠ê\dots\\)      
CMÔºö‰ΩøÁî®ÈöêÂºè Laplacian Áü©ÈòµÔºå‰∫åÈò∂ÊñπÊ≥ï„ÄÅÈÄüÂ∫¶Êõ¥Âø´   
ÂêÑÁßçÊñπÊ≥ïÈÉΩÊòØÊâæÊõ¥Â•ΩÁöÑHËøë‰ººÔºå‰ΩøÂæó‰ºòÂåñËøáÁ®ãÊõ¥Âø´Êõ¥Á®≥ÂÆö„ÄÇ    

## Scalable Locally Injective Mappings (SLIM)

&#x2705; **H** = reweighted Laplacian L    
&#x2705; Compute the weight matrix \\(W_J\\) by the matching  gradients condition     

$$
\nabla_JE_W^R = \nabla_JE_{RI}
$$

&#x2705; Quickly recovers from a bad initialization, but slowly converge to a local minimum     
&#x2705; First‚Äêorder method    

![](../assets/ÂèÇÊï∞34.png)     

> Rabinovich et al. Scalable Locally Injective Mappings. Siggraph 2017.   



## Isometry‚ÄêAware Preconditioning (AKVF)   


&#x2705; **H** = approximate killing vector field perator \\(K(x)\\)    
&#x2705; \\(K(x)\\) converts the local distortion gradient into a global near‚Äêrigid decent direction     
&#x2705; First‚Äêorder method    

![](../assets/ÂèÇÊï∞35.png)     

> Claici et al. Isometry‚ÄêAware Preconditioning for Mesh Parameterization. SGP 2017.     

## Composite Majorization (CM)   


&#x2705; Use a tight convex proxy to approximate the 
objective function by convex‚Äêconcave decomposition    

$$
E=E^++E^-
$$

&#x2705;  \\(H = \nabla^2E^+\\)     
&#x2705; Second‚Äêorder method    

![](../assets/ÂèÇÊï∞36.png)     

> Shtengel et al. Geometric Optimization via Composite Majorization. Siggraph 2017.


## Blended Cured Quasi‚ÄêNewton (BCQN)    

&#x2705; Blended quasi‚ÄêNewton method    
&#x2705; Barrier‚Äêaware line search filtering     
&#x2705; Second‚Äêorder method    

![](../assets/ÂèÇÊï∞37.png)     

> Zhu et al. Blended Cured quasi‚ÄêNewton for Distortion Optimization. Siggraph 2018.

# Progressive Paramerization    

* Key observations    
‚Ä¢ Near‚Äêdegenerate triangles (i.e., large distortion) in the initializations by Tutte‚Äôs method    
‚Ä¢ Small iterative step and slow convergence in existing methods    
‚Ä¢ Key: even one **extremely large distortion** term can **restrict** the line search **step** size!    

![](../assets/ÂèÇÊï∞38.png)     

> [Ligang Liu et al.  Progressive Parameterizations. Siggraph 2018]     

> ÈóÆÈ¢òÊèèËø∞Ôºö   
[Âõæ28:52]‰∫ÜËÑñÂ≠ê‰∏∫ËæπÁïå.Â§¥Êå§Âú®‰∏≠Èó¥Ôºå‰∏≠Èó¥Êâ≠Êõ≤ÂæàÂ§ß‚áíËÉΩÈáèÂ§ß‚áí‰∏ãÈôçÊÖ¢     
Ëß£ÂÜ≥ÊñπÊ≥ïÔºö    
[Âõæ29:29] ‰∏ç‰ºòÂåñÊï¥‰ΩìÔºåËÄåÊòØ‰∏≠Èó¥ÈÇ£Âå∫Âüü     
*‰∏™‰∫∫ÊÑüËßâ‰∏ç make sense *    
[Âõæ30:35]

![](../assets/ÂèÇÊï∞39.png)     

> [Ligang Liu et al.  Progressive Parameterizations. Siggraph 2018]   


![](../assets/ÂèÇÊï∞40.png)     

![](../assets/ÂèÇÊï∞41.png)     


